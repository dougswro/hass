2023-07-11 05:23:26.767 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration entity_controller which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.771 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration rpi_gpio which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.775 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration ssh which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.778 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration ytube_music_player which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.781 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration lovelace_gen which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.783 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration pyscript which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.786 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration ui_lovelace_minimalist which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.790 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration var which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.793 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration webhook_service which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.795 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration onewire_sysbus which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.797 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration multizone_controller which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.800 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration facebook_messenger which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.803 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration themeparks which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.807 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration edge_tts which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.811 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration deebot which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.817 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration nodered which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.820 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration cover_rf_time_based which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.822 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration schedule_state which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.825 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration fontawesome which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.828 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration media_player_template which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.830 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration variable which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.836 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration eventsensor which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.839 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration config_editor which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.842 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration simpleicons which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.845 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration meross_lan which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.848 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration scheduler which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.853 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration hacs which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.856 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration google_home which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.859 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration sonos_alarm which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.865 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration samsungtv_tizen which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.868 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration openweathermaphistory which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.871 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration samsungtv_custom which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.871 ERROR (SyncWorker_3) [homeassistant.loader] The custom integration 'samsungtv_custom' does not have a version key in the manifest file and was blocked from loading. See https://developers.home-assistant.io/blog/2021/01/29/custom-integration-changes#versions for more details
2023-07-11 05:23:26.874 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration meross_cloud which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.877 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration teamtracker which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.881 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration auto_backup which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:26.884 WARNING (SyncWorker_3) [homeassistant.loader] We found a custom integration rpi_rf which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
2023-07-11 05:23:32.327 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:35.421 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:38.478 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:41.514 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:42.070 WARNING (MainThread) [homeassistant.setup] Setup of recorder is taking over 10 seconds.
2023-07-11 05:23:44.544 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:47.578 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:50.614 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:53.645 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:56.678 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:23:59.710 ERROR (Recorder) [homeassistant.components.recorder.core] Error during connection setup:  (retrying in 3 seconds)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 924, in _setup_recorder
    self._setup_connection()
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 1397, in _setup_connection
    Base.metadata.create_all(self.engine)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py", line 5796, in create_all
    bind._run_ddl_visitor(
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3244, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2448, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 670, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in visit_metadata
    [t for t in tables if self._can_create_table(t)]
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 901, in <listcomp>
    [t for t in tables if self._can_create_table(t)]
                          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py", line 866, in _can_create_table
    return not self.checkfirst or not self.dialect.has_table(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in has_table
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 88, in cache
    return fn(self, con, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/mysql/base.py", line 2695, in has_table
    assert schema is not None
           ^^^^^^^^^^^^^^^^^^
AssertionError
2023-07-11 05:24:02.724 ERROR (MainThread) [homeassistant.setup] Setup failed for recorder: Integration failed to initialize.
2023-07-11 05:24:33.158 ERROR (MainThread) [homeassistant.components.sensor] The mqtt platform for the sensor integration does not support platform setup. Please remove it from your config.
2023-07-11 05:24:33.260 ERROR (MainThread) [homeassistant.components.sensor] Error while setting up pyload platform for sensor
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/helpers/entity_platform.py", line 353, in _async_setup_platform
    await asyncio.shield(task)
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/pyload/sensor.py", line 82, in setup_platform
    pyloadapi = PyLoadAPI(api_url=url, username=username, password=password)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/pyload/sensor.py", line 149, in __init__
    self.update()
  File "/usr/src/homeassistant/homeassistant/util/__init__.py", line 190, in wrapper
    result = method(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/pyload/sensor.py", line 171, in update
    self.status = self.post()
                  ^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/pyload/sensor.py", line 156, in post
    cookies=self.login.cookies,
            ^^^^^^^^^^
AttributeError: 'PyLoadAPI' object has no attribute 'login'
2023-07-11 05:24:33.665 ERROR (MainThread) [homeassistant.setup] Unable to set up dependencies of logbook. Setup failed for dependencies: recorder
2023-07-11 05:24:33.672 ERROR (MainThread) [homeassistant.setup] Setup failed for logbook: (DependencyError(...), 'Could not setup dependencies: recorder')
2023-07-11 05:24:33.774 ERROR (MainThread) [homeassistant.setup] Unable to set up dependencies of history. Setup failed for dependencies: recorder
2023-07-11 05:24:33.782 ERROR (MainThread) [homeassistant.setup] Setup failed for history: (DependencyError(...), 'Could not setup dependencies: recorder')
2023-07-11 05:24:35.226 WARNING (MainThread) [homeassistant.components.automation.config] The 'hide_entity' option near /config/automation/full_house_modes.yaml:0 is deprecated, please remove it from your configuration
2023-07-11 05:24:35.269 ERROR (MainThread) [homeassistant.setup] Unable to set up dependencies of energy. Setup failed for dependencies: history, recorder
2023-07-11 05:24:35.271 ERROR (MainThread) [homeassistant.setup] Setup failed for energy: (DependencyError(...), 'Could not setup dependencies: history, recorder')
2023-07-11 05:24:47.444 WARNING (MainThread) [mqtt] We renamed asyncio-mqtt to aiomqtt and released a version 1.0.0 in the process. This is the last release under the asyncio-mqtt name. You can find the new repository at https://github.com/sbtinstruments/aiomqtt
2023-07-11 05:24:49.192 WARNING (MainThread) [homeassistant.bootstrap] Waiting on integrations to complete setup: sun, mqtt, brother, lastfm, bond, androidtv_remote, samsungtv, hacs, ipp, tplink, roku, wiz, matter, deebot, radio_browser, dlna_dmr, esphome, notify, notify.telegram, notify.html5
2023-07-11 05:24:49.206 ERROR (SyncWorker_0) [homeassistant.util.json] Could not parse JSON content: /config/html5_push_registrations.conf
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/util/json.py", line 68, in load_json
    return orjson.loads(fdesc.read())  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
orjson.JSONDecodeError: Input is a zero-length, empty document: line 1 column 1 (char 0)
2023-07-11 05:24:52.592 WARNING (MainThread) [homeassistant.config_entries] Config entry 'Space Heater - 5 HS103(US)' for tplink integration not ready yet: Unable to connect to the device: 192.168.1.33: [Errno 113] Connect call failed ('192.168.1.33', 9999); Retrying in background
2023-07-11 05:24:52.599 WARNING (MainThread) [homeassistant.config_entries] Config entry 'Living Room Lamp HS103(US)' for tplink integration not ready yet: Unable to connect to the device: 192.168.1.6: [Errno 113] Connect call failed ('192.168.1.6', 9999); Retrying in background
2023-07-11 05:24:53.728 ERROR (MainThread) [homeassistant.setup] Unable to set up dependencies of default_config. Setup failed for dependencies: energy, history, logbook
2023-07-11 05:24:53.730 ERROR (MainThread) [homeassistant.setup] Setup failed for default_config: (DependencyError(...), 'Could not setup dependencies: energy, history, logbook')
2023-07-11 05:24:53.812 WARNING (MainThread) [custom_components.meross_lan] MerossDevice(Garage Door Opener): MLGarage(cover.garage_door_opener_garage) RuntimeError(The database connection has not been established) in restoring previous state
2023-07-11 05:24:55.205 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 05:24:56.580 WARNING (MainThread) [aioesphomeapi.reconnect_logic] Can't connect to ESPHome API for r @ 192.168.1.36: Error connecting to ('192.168.1.36', 6053): [Errno 113] Connect call failed ('192.168.1.36', 6053) (SocketAPIError)
2023-07-11 05:25:04.718 WARNING (MainThread) [custom_components.hacs] You have 'nagyrobi/home-assistant-custom-components-cover-rf-time-based' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (Repository is archived)
2023-07-11 05:25:04.724 WARNING (MainThread) [custom_components.hacs] You have 'Villhellm/custom-sidebar' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (No longer working and can not be maintained)
2023-07-11 05:25:04.729 WARNING (MainThread) [custom_components.hacs] You have 'nagyrobi/home-assistant-custom-components-cover-rf-time-based' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (Repository is archived)
2023-07-11 05:25:04.732 WARNING (MainThread) [custom_components.hacs] You have 'Villhellm/custom-sidebar' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (No longer working and can not be maintained)
2023-07-11 05:25:11.914 ERROR (MainThread) [homeassistant.loader] Unexpected exception importing platform custom_components.sonos_alarm.config_flow
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/loader.py", line 833, in get_platform
    cache[full_name] = self._import_platform(platform_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/loader.py", line 850, in _import_platform
    return importlib.import_module(f"{self.pkg_path}.{platform_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/config/custom_components/sonos_alarm/config_flow.py", line 15, in <module>
    config_entry_flow.register_discovery_flow(
TypeError: register_discovery_flow() takes 3 positional arguments but 4 were given
2023-07-11 05:25:11.930 ERROR (MainThread) [homeassistant.config_entries] Error occurred loading flow for integration sonos_alarm: Exception importing custom_components.sonos_alarm.config_flow
2023-07-11 05:25:11.965 ERROR (MainThread) [homeassistant.loader] Unexpected exception importing platform custom_components.sonos_alarm.config_flow
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/loader.py", line 833, in get_platform
    cache[full_name] = self._import_platform(platform_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/loader.py", line 850, in _import_platform
    return importlib.import_module(f"{self.pkg_path}.{platform_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/config/custom_components/sonos_alarm/config_flow.py", line 15, in <module>
    config_entry_flow.register_discovery_flow(
TypeError: register_discovery_flow() takes 3 positional arguments but 4 were given
2023-07-11 05:25:11.975 ERROR (MainThread) [homeassistant.config_entries] Error occurred loading flow for integration sonos_alarm: Exception importing custom_components.sonos_alarm.config_flow
2023-07-11 05:25:11.980 ERROR (MainThread) [homeassistant] Error doing job: Task exception was never retrieved
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/loader.py", line 833, in get_platform
    cache[full_name] = self._import_platform(platform_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/loader.py", line 850, in _import_platform
    return importlib.import_module(f"{self.pkg_path}.{platform_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/config/custom_components/sonos_alarm/config_flow.py", line 15, in <module>
    config_entry_flow.register_discovery_flow(
TypeError: register_discovery_flow() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 2045, in _load_integration
    integration.get_platform("config_flow")
  File "/usr/src/homeassistant/homeassistant/loader.py", line 842, in get_platform
    raise ImportError(
ImportError: Exception importing custom_components.sonos_alarm.config_flow

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/helpers/discovery_flow.py", line 95, in _async_start
    await gather_with_concurrency(
  File "/usr/src/homeassistant/homeassistant/util/async_.py", line 185, in gather_with_concurrency
    return await gather(
           ^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/util/async_.py", line 183, in sem_task
    return await task
           ^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 856, in async_init
    flow, result = await task
                   ^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 874, in _async_init
    flow = await self.async_create_flow(handler, context=context, data=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 974, in async_create_flow
    await _load_integration(self.hass, handler_key, self._hass_config)
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 2052, in _load_integration
    raise data_entry_flow.UnknownHandler
homeassistant.data_entry_flow.UnknownHandler
2023-07-11 05:25:12.051 ERROR (MainThread) [homeassistant.loader] Unexpected exception importing platform custom_components.sonos_alarm.config_flow
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/loader.py", line 833, in get_platform
    cache[full_name] = self._import_platform(platform_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/loader.py", line 850, in _import_platform
    return importlib.import_module(f"{self.pkg_path}.{platform_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/config/custom_components/sonos_alarm/config_flow.py", line 15, in <module>
    config_entry_flow.register_discovery_flow(
TypeError: register_discovery_flow() takes 3 positional arguments but 4 were given
2023-07-11 05:25:12.062 ERROR (MainThread) [homeassistant.config_entries] Error occurred loading flow for integration sonos_alarm: Exception importing custom_components.sonos_alarm.config_flow
2023-07-11 05:25:12.100 ERROR (MainThread) [homeassistant.loader] Unexpected exception importing platform custom_components.sonos_alarm.config_flow
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/loader.py", line 833, in get_platform
    cache[full_name] = self._import_platform(platform_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/loader.py", line 850, in _import_platform
    return importlib.import_module(f"{self.pkg_path}.{platform_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/config/custom_components/sonos_alarm/config_flow.py", line 15, in <module>
    config_entry_flow.register_discovery_flow(
TypeError: register_discovery_flow() takes 3 positional arguments but 4 were given
2023-07-11 05:25:12.111 ERROR (MainThread) [homeassistant.config_entries] Error occurred loading flow for integration sonos_alarm: Exception importing custom_components.sonos_alarm.config_flow
2023-07-11 05:26:07.857 ERROR (MainThread) [homeassistant.loader] Unexpected exception importing platform custom_components.sonos_alarm.config_flow
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/loader.py", line 833, in get_platform
    cache[full_name] = self._import_platform(platform_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/loader.py", line 850, in _import_platform
    return importlib.import_module(f"{self.pkg_path}.{platform_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/config/custom_components/sonos_alarm/config_flow.py", line 15, in <module>
    config_entry_flow.register_discovery_flow(
TypeError: register_discovery_flow() takes 3 positional arguments but 4 were given
2023-07-11 05:26:07.866 ERROR (MainThread) [homeassistant.config_entries] Error occurred loading flow for integration sonos_alarm: Exception importing custom_components.sonos_alarm.config_flow
2023-07-11 05:26:07.869 ERROR (MainThread) [homeassistant] Error doing job: Task exception was never retrieved
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/loader.py", line 833, in get_platform
    cache[full_name] = self._import_platform(platform_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/loader.py", line 850, in _import_platform
    return importlib.import_module(f"{self.pkg_path}.{platform_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/config/custom_components/sonos_alarm/config_flow.py", line 15, in <module>
    config_entry_flow.register_discovery_flow(
TypeError: register_discovery_flow() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 2045, in _load_integration
    integration.get_platform("config_flow")
  File "/usr/src/homeassistant/homeassistant/loader.py", line 842, in get_platform
    raise ImportError(
ImportError: Exception importing custom_components.sonos_alarm.config_flow

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 856, in async_init
    flow, result = await task
                   ^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 874, in _async_init
    flow = await self.async_create_flow(handler, context=context, data=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 974, in async_create_flow
    await _load_integration(self.hass, handler_key, self._hass_config)
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 2052, in _load_integration
    raise data_entry_flow.UnknownHandler
homeassistant.data_entry_flow.UnknownHandler
2023-07-11 05:39:12.879 WARNING (MainThread) [homeassistant.components.automation.config] The 'hide_entity' option near /config/automation/full_house_modes.yaml:0 is deprecated, please remove it from your configuration
2023-07-11 05:45:12.222 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 05:45:22.088 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 06:31:26.408 WARNING (MainThread) [homeassistant.components.http.security_filter] Filtered a potential harmful request to: /cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh
2023-07-11 07:33:22.137 ERROR (MainThread) [custom_components.hacs] HACS is disabled - invalid_token
2023-07-11 07:33:22.151 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547437005072] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (Linux; Android 13; Pixel 7 Build/TQ3A.230705.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/115.0.5790.69 Mobile Safari/537.36 Home Assistant/2023.6.0-10170 (Android 13; Pixel 7))
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/update/__init__.py", line 465, in websocket_release_notes
    await entity.async_release_notes(),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/config/custom_components/hacs/update.py", line 94, in async_release_notes
    releases = await self.repository.get_releases(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/config/custom_components/hacs/repositories/base.py", line 1046, in get_releases
    response = await self.hacs.async_github_api_method(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/config/custom_components/hacs/base.py", line 522, in async_github_api_method
    raise HacsException(_exception)
custom_components.hacs.exceptions.HacsException: Bad credentials
2023-07-11 07:33:23.404 ERROR (MainThread) [custom_components.hacs] <Plugin piitaya/lovelace-mushroom> HttpStatusCode.UNAUTHORIZED
2023-07-11 07:33:23.414 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547437005072] 'NoneType' object has no attribute 'replace'
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/commands.py", line 205, in handle_call_service
    await hass.services.async_call(
  File "/usr/src/homeassistant/homeassistant/core.py", line 1957, in async_call
    response_data = await coro
                    ^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/core.py", line 1997, in _execute_service
    return await cast(
           ^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/helpers/entity_component.py", line 235, in handle_service
    return await service.entity_service_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/helpers/service.py", line 845, in entity_service_call
    response_data = task.result()  # pop exception if have
                    ^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/helpers/entity.py", line 1192, in async_request_call
    return await coro
           ^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/helpers/service.py", line 889, in _handle_entity_call
    result = await task
             ^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/update/__init__.py", line 156, in async_install
    await entity.async_install_with_progress(version, backup)
  File "/usr/src/homeassistant/homeassistant/components/update/__init__.py", line 414, in async_install_with_progress
    await self.async_install(version, backup)
  File "/config/custom_components/hacs/update.py", line 83, in async_install
    await self.repository.update_repository(force=True)
  File "/config/custom_components/hacs/utils/decorator.py", line 28, in wrapper
    result = await function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/config/custom_components/hacs/repositories/plugin.py", line 71, in update_repository
    f"{self.string} Repository structure for {self.ref.replace('tags/','')} is not compliant"
                                              ^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'replace'
2023-07-11 07:47:03.884 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 07:48:16.967 WARNING (MainThread) [aioesphomeapi.connection] r @ 192.168.1.36: Connection error occurred: [Errno 104] Connection reset by peer
2023-07-11 07:54:12.273 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [548015905744] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) QtWebEngine/5.15.13 Chrome/87.0.4280.144 Safari/537.36)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/update/__init__.py", line 465, in websocket_release_notes
    await entity.async_release_notes(),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/config/custom_components/hacs/update.py", line 94, in async_release_notes
    releases = await self.repository.get_releases(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/config/custom_components/hacs/repositories/base.py", line 1046, in get_releases
    response = await self.hacs.async_github_api_method(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/config/custom_components/hacs/base.py", line 522, in async_github_api_method
    raise HacsException(_exception)
custom_components.hacs.exceptions.HacsException: Bad credentials
2023-07-11 07:54:43.930 ERROR (MainThread) [homeassistant.config_entries] Error setting up entry  for sensor
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 390, in async_setup
    result = await component.async_setup_entry(hass, self)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/sensor/__init__.py", line 131, in async_setup_entry
    return await component.async_setup_entry(entry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/helpers/entity_component.py", line 187, in async_setup_entry
    raise ValueError("Config entry has already been setup!")
ValueError: Config entry has already been setup!
2023-07-11 07:54:43.955 ERROR (MainThread) [homeassistant.config_entries] Error setting up entry  for update
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/config_entries.py", line 390, in async_setup
    result = await component.async_setup_entry(hass, self)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/update/__init__.py", line 117, in async_setup_entry
    return await component.async_setup_entry(entry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/helpers/entity_component.py", line 187, in async_setup_entry
    raise ValueError("Config entry has already been setup!")
ValueError: Config entry has already been setup!
2023-07-11 07:54:44.195 WARNING (MainThread) [custom_components.hacs] You have 'nagyrobi/home-assistant-custom-components-cover-rf-time-based' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (Repository is archived)
2023-07-11 07:54:44.199 WARNING (MainThread) [custom_components.hacs] You have 'Villhellm/custom-sidebar' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (No longer working and can not be maintained)
2023-07-11 07:54:44.822 WARNING (MainThread) [custom_components.hacs] You have 'nagyrobi/home-assistant-custom-components-cover-rf-time-based' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (Repository is archived)
2023-07-11 07:54:44.827 WARNING (MainThread) [custom_components.hacs] You have 'Villhellm/custom-sidebar' installed with HACS this repository has been removed from HACS, please consider removing it. Removal reason (No longer working and can not be maintained)
2023-07-11 08:01:24.542 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:00:01.068 WARNING (MainThread) [homeassistant.components.automation] Error evaluating condition in 'Clean Ryan's room':
In 'condition':
  In 'state':
    In 'state' condition: unknown entity person.ryan
2023-07-11 09:23:59.912 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:24:34.445 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:29:48.797 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:30:23.027 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:33:34.125 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:40:43.411 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:40:53.319 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:55:03.759 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:55:13.424 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:58:50.156 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:59:09.765 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 09:59:49.880 WARNING (MainThread) [aioesphomeapi.connection] r @ 192.168.1.36: Connection error occurred: Ping response not received after 90.0 seconds
2023-07-11 09:59:52.932 WARNING (MainThread) [aioesphomeapi.reconnect_logic] Can't connect to ESPHome API for r @ 192.168.1.36: Error connecting to ('192.168.1.36', 6053): [Errno 113] Connect call failed ('192.168.1.36', 6053) (SocketAPIError)
2023-07-11 10:12:40.769 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 10:23:35.062 ERROR (MainThread) [homeassistant.components.tplink.coordinator] Error fetching 192.168.1.9 data: Unable to connect to the device: 192.168.1.9: 
2023-07-11 10:23:48.736 WARNING (MainThread) [homeassistant.config_entries] Config entry 'Living Room Lamp HS103(US)' for tplink integration not ready yet: Unable to connect to the device: 192.168.1.6: [Errno 111] Connect call failed ('192.168.1.6', 9999); Retrying in background
2023-07-11 10:24:09.369 WARNING (MainThread) [homeassistant.config_entries] Config entry 'Space Heater - 5 HS103(US)' for tplink integration not ready yet: Unable to connect to the device: 192.168.1.33: [Errno 111] Connect call failed ('192.168.1.33', 9999); Retrying in background
2023-07-11 10:24:56.490 WARNING (MainThread) [homeassistant.components.http.ban] Login attempt or request with invalid authentication from 075-136-249-020.res.spectrum.com (75.136.249.20). Requested URL: '/media/local/Plex/Music/UNDERTALE%20/toby%20fox%20-%20UNDERTALE%20Soundtrack%20-%2014%20Heartache.flac?authSig=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZDUwNjQ5YzAyY2U0M2E1YjkxZTg2NzU0ZDhkMzc5OSIsInBhdGgiOiIvbWVkaWEvbG9jYWwvUGxleC9NdXNpYy9VTkRFUlRBTEUgL3RvYnkgZm94IC0gVU5ERVJUQUxFIFNvdW5kdHJhY2sgLSAxNCBIZWFydGFjaGUuZmxhYyIsInBhcmFtcyI6W10sImlhdCI6MTY4ODY4MTQ1MSwiZXhwIjoxNjg4NzY3ODUxfQ.rYeQbJ6VL2LA3Z113LFXbL7J927nHMs0FRo_pBI4QyQ'. (Linux UPnP/1.0 Sonos/73.0-42060 (ZPS38))
2023-07-11 10:27:08.149 WARNING (MainThread) [homeassistant.components.media_player] Error retrieving proxied image from http://192.168.1.69:1400
2023-07-11 10:27:08.331 ERROR (MainThread) [frontend.js.latest.202307051] https://roccoshouse.duckdns.org/hacsfiles/light-entity-row/light-entity-row.js?hacstag=151318225025:10:1 ReferenceError: Polymer is not defined
2023-07-11 10:27:39.910 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:39.954 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:39.963 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:39.972 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:44.335 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:44.444 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:44.746 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:45.466 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:45.544 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:45.841 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:46.205 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:46.419 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:46.485 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:46.703 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:46.906 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:47.294 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:47.407 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:27:53.025 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:28:38.466 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:28:50.179 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:28:52.859 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:28:52.868 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:28:52.938 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:28:58.498 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:00.304 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:08.289 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:08.300 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:10.852 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:16.329 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:29.859 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:29.870 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:29.925 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:33.550 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: expected str @ data['statistic_ids'][0]. Got None (invalid_format) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
2023-07-11 10:29:40.649 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:46.008 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:29:59.089 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:08.485 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:21.423 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:21.434 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:21.440 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:25.674 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:29.495 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:29.874 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:29.972 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:31.563 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:31.774 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:32.601 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:32.687 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:32.958 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:33.092 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:34.587 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:48.060 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:51.314 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:51.489 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:51.777 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:52.345 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:52.446 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:52.860 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:53.170 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:53.377 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:53.498 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:53.662 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:53.870 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:54.158 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:54.310 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:30:58.021 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:31:12.655 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: expected str @ data['statistic_ids'][0]. Got None (invalid_format) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
2023-07-11 10:31:12.662 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: expected str @ data['statistic_ids'][0]. Got None (invalid_format) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
2023-07-11 10:31:12.669 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:09.506 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:09.520 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:09.527 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:09.534 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 280, in ws_list_statistic_ids
    await ws_handle_list_statistic_ids(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 260, in ws_handle_list_statistic_ids
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 251, in _ws_get_list_statistic_ids
    messages.result_message(msg_id, list_statistic_ids(hass, None, statistic_type))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:16.800 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:16.812 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:16.975 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:16.989 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:17.157 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:17.168 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:17.261 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:17.273 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:18.062 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:18.073 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:20.641 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 334, in ws_get_statistics_metadata
    metadata = await async_list_statistic_ids(hass, statistic_ids_set_or_none)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 707, in async_list_statistic_ids
    return await instance.async_add_executor_job(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 771, in list_statistic_ids
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:34.505 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 238, in ws_get_statistics_during_period
    await ws_handle_get_statistics_during_period(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 205, in ws_handle_get_statistics_during_period
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 160, in _ws_get_statistics_during_period
    result = statistics_during_period(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 1711, in statistics_during_period
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:34:39.939 ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [547346085584] Error handling message: Unknown error (unknown_error) doug from 75.136.249.20 (Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0)
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/websocket_api/decorators.py", line 26, in _handle_async_response
    await func(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 238, in ws_get_statistics_during_period
    await ws_handle_get_statistics_during_period(hass, connection, msg)
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 205, in ws_handle_get_statistics_during_period
    await get_instance(hass).async_add_executor_job(
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/websocket_api.py", line 160, in _ws_get_statistics_during_period
    result = statistics_during_period(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/statistics.py", line 1711, in statistics_during_period
    with session_scope(hass=hass, read_only=True) as session:
  File "/usr/local/lib/python3.11/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/util.py", line 123, in session_scope
    session = get_instance(hass).get_session()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/recorder/core.py", line 274, in get_session
    raise RuntimeError("The database connection has not been established")
RuntimeError: The database connection has not been established
2023-07-11 10:42:45.901 ERROR (MainThread) [homeassistant.components.tplink.coordinator] Error fetching 192.168.1.33 data: Unable to connect to the device: 192.168.1.33: [Errno 111] Connect call failed ('192.168.1.33', 9999)
2023-07-11 10:46:47.354 WARNING (MainThread) [homeassistant.components.automation.config] The 'hide_entity' option near /config/automation/full_house_modes.yaml:0 is deprecated, please remove it from your configuration
2023-07-11 10:46:52.458 WARNING (MainThread) [homeassistant.components.automation.config] The 'hide_entity' option near /config/automation/full_house_modes.yaml:0 is deprecated, please remove it from your configuration
2023-07-11 10:47:04.049 ERROR (MainThread) [homeassistant] Error doing job: Task exception was never retrieved
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/bond/entity.py", line 131, in _async_update
    await self._async_update_from_api()
  File "/usr/src/homeassistant/homeassistant/components/bond/entity.py", line 137, in _async_update_from_api
    state: dict = await self._hub.bond.device_state(self._device_id)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/bond_async/bond.py", line 66, in device_state
    return await self.__get(f"/v2/devices/{device_id}/state")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/bond_async/bond.py", line 162, in __get
    return await self.__call(get)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/bond_async/bond.py", line 170, in __call
    return await handler(self._session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/bond_async/bond.py", line 156, in get
    async with session.get(
  File "/usr/local/lib/python3.11/site-packages/aiohttp/client.py", line 1141, in __aenter__
    self._resp = await self._coro
                 ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/aiohttp/client.py", line 400, in _request
    raise RuntimeError("Session is closed")
RuntimeError: Session is closed
